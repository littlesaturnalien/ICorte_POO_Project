{"ast":null,"code":"var _jsxFileName = \"/Users/karen_fonseca/Documents/UAM/Proyecto I Corte - Frontend/student-id-keeper/carnet-uam-frontend/src/pages/admin/StudentIDCard.jsx\",\n  _s = $RefreshSig$();\n// src/pages/admin/StudentIdCardPage.jsx\nimport React, { useEffect, useState } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport axios from 'axios';\nimport AdminLayout from '../../layouts/AdminLayout';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = 'http://localhost:8087/uam-carnet-sys';\nconst STATUS_OPTS = ['PENDING', 'APPROVED', 'REJECTED', 'DELIVERED', 'EMITTED'];\n\n/* Paleta de colores personalizada */\nconst C = {\n  tealLight: '#4da4ab',\n  tealMid: '#487e84',\n  tealDark: '#0b545b',\n  black: '#2d2e3c'\n};\n\n/* helpers fecha */\nconst toISODate = d => {\n  if (!d) return '';\n  const iso = d.match(/^\\d{4}[-/]\\d{2}[-/]\\d{2}/);\n  if (iso) return iso[0].replace(/\\//g, '-');\n  const dm = d.match(/^(\\d{2})[-/](\\d{2})[-/](\\d{4})/);\n  return dm ? `${dm[3]}-${dm[2]}-${dm[1]}` : '';\n};\nconst b2iso = s => s ? `${s.slice(6, 10)}-${s.slice(3, 5)}-${s.slice(0, 2)}T${s.slice(11)}` : '';\nconst iso2b = s => s ? `${s.slice(8, 10)}-${s.slice(5, 7)}-${s.slice(0, 4)} ${s.slice(11)}` : '';\nexport default function StudentIdCardPage() {\n  _s();\n  const {\n    cif\n  } = useParams();\n  const [cards, setCards] = useState([]);\n  const [reqs, setReqs] = useState([]);\n  const [stu, setStu] = useState([]);\n  const [edit, setEdit] = useState({});\n  const [open, setOpen] = useState(null);\n  const load = async () => {\n    const [cRes, rRes, sRes] = await Promise.all([axios.get(`${API}/idcard`), axios.get(`${API}/requirement`), axios.get(`${API}/student`)]);\n    const c = cRes.data.filter(i => i.cif === cif);\n    const r = rRes.data.filter(i => i.cif === cif);\n    setCards(c);\n    setReqs(r);\n    setStu(sRes.data.filter(s => s.cif === cif));\n    const st = {};\n    c.forEach(cd => {\n      const req = r.find(q => q.requirementId === cd.requirement_id);\n      st[cd.idCardId] = {\n        status: cd.status,\n        notes: cd.notes || '',\n        issueDate: toISODate(cd.issueDate),\n        deliveryAppointment: b2iso(cd.deliveryAppointment),\n        pictureId: cd.picture_id,\n        pictureUrl: cd.picture_url || '',\n        photoAppointment: b2iso(cd.photoAppointment),\n        requirementId: req === null || req === void 0 ? void 0 : req.requirementId,\n        paymentProofUrl: (req === null || req === void 0 ? void 0 : req.paymentProofUrl) || '',\n        motive: (req === null || req === void 0 ? void 0 : req.motive) || 'No indicado',\n        expirationDate: cd.expirationDate || 'No especificada',\n        selectedDegreeName: cd.selectedDegreeName || 'No indicada'\n      };\n    });\n    setEdit(st);\n  };\n  useEffect(() => {\n    load();\n  }, [cif]);\n  const keepOpen = i => setOpen(i);\n  const saveCard = async (cd, idx) => {\n    const e = edit[cd.idCardId];\n    try {\n      const dates = {};\n      if (e.issueDate && e.issueDate !== toISODate(cd.issueDate)) dates.issueDate = e.issueDate;\n      if (e.deliveryAppointment && iso2b(e.deliveryAppointment) !== cd.deliveryAppointment) dates.deliveryAppointment = iso2b(e.deliveryAppointment);\n      if (Object.keys(dates).length) await axios.patch(`${API}/idcard/${cd.idCardId}/dates`, dates);\n      if (e.status !== cd.status) await axios.patch(`${API}/idcard/${cd.idCardId}/status`, {\n        status: e.status\n      });\n      const note = (e.notes || '').trim();\n      if (note && note !== (cd.notes || '').trim()) await axios.patch(`${API}/idcard/${cd.idCardId}/addNotes`, {\n        notes: note\n      });\n      alert('✅ Carnet actualizado');\n      await load();\n      keepOpen(idx);\n    } catch (err) {\n      console.error(err);\n      alert('❌ Error al guardar carnet');\n    }\n  };\n  const savePic = async (cd, idx) => {\n    const e = edit[cd.idCardId];\n    if (!e.requirementId) return alert('requirementId faltante');\n    try {\n      var _reqRes$data$data;\n      const reqRes = await axios.get(`${API}/requirement/${e.requirementId}`);\n      const reqObj = (_reqRes$data$data = reqRes.data.data) !== null && _reqRes$data$data !== void 0 ? _reqRes$data$data : reqRes.data;\n      const picId = reqObj.pictureId;\n      if (!picId) return alert('pictureId no encontrado en el requirement');\n      await axios.put(`${API}/picture/${picId}`, {\n        ...(e.photoAppointment && {\n          photoAppointment: iso2b(e.photoAppointment)\n        }),\n        cif: cd.cif,\n        photoUrl: e.pictureUrl\n      });\n      alert('✅ Foto guardada');\n      await load();\n      keepOpen(idx);\n    } catch (err) {\n      console.error(err);\n      alert('❌ Error al guardar foto');\n    }\n  };\n  const saveReq = async (cd, idx) => {\n    const e = edit[cd.idCardId];\n    if (!e.requirementId) return alert('requirementId faltante');\n    try {\n      await axios.put(`${API}/requirement/${e.requirementId}`, {\n        paymentProofUrl: e.paymentProofUrl\n      });\n      alert('✅ Comprobante guardado');\n      await load();\n      keepOpen(idx);\n    } catch (err) {\n      console.error(err);\n      alert('❌ Error al guardar comprobante');\n    }\n  };\n  const studentName = stu.length ? `${stu[0].names} ${stu[0].surnames}` : '';\n  return /*#__PURE__*/_jsxDEV(AdminLayout, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto mt-10 p-6 bg-white rounded shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold mb-4\",\n        children: [\"Solicitudes de Carnet de \", studentName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/admin/students\",\n        className: \"text-[#0b545b] underline mb-6 block\",\n        children: \"\\u2190 Volver a Estudiantes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this), !cards.length && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"No hay solicitudes.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 33\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4 max-h-[70vh] overflow-y-auto pr-2\",\n        children: cards.map((c, i) => {\n          const e = edit[c.idCardId] || {};\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setOpen(open === i ? null : i),\n              className: \"w-full p-4 bg-gray-100 flex justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-semibold\",\n                children: [\"Semestre \", c.semester, \" \", c.year, \" \\u2014 \", c.status]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: open === i ? '−' : '+'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 33\n            }, this), open === i && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-4 space-y-5 bg-white rounded-b-lg\",\n              children: [/*#__PURE__*/_jsxDEV(\"section\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-lg font-medium\",\n                  children: \"Detalles de la Solicitud\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Carrera:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 157,\n                    columnNumber: 48\n                  }, this), \" \", e.selectedDegreeName || 'No especificada']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Fecha de vencimiento:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 158,\n                    columnNumber: 48\n                  }, this), \" \", e.expirationDate]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Motivo:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 159,\n                    columnNumber: 48\n                  }, this), \" \", e.motive]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-lg font-medium\",\n                  children: \"Carnet\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold\",\n                    children: \"Estado\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: e.status,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        status: ev.target.value\n                      }\n                    }),\n                    className: \"border px-2 py-1 rounded\",\n                    children: STATUS_OPTS.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n                      children: s\n                    }, s, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 172,\n                      columnNumber: 75\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold\",\n                    children: \"Emisi\\xF3n\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 176,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"date\",\n                    className: \"border px-2 py-1 rounded\",\n                    value: e.issueDate,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        issueDate: ev.target.value\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 177,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold\",\n                    children: \"Entrega\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 185,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"datetime-local\",\n                    className: \"border px-2 py-1 rounded\",\n                    value: e.deliveryAppointment,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        deliveryAppointment: ev.target.value\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 186,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-start\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold mt-1\",\n                    children: \"Notas\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 194,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                    rows: 3,\n                    className: \"border px-2 py-1 rounded w-full\",\n                    value: e.notes,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        notes: ev.target.value\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 195,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => saveCard(c, i),\n                  className: \"text-white px-3 py-1 rounded\",\n                  style: {\n                    backgroundColor: C.tealMid\n                  },\n                  children: \"Guardar Carnet\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 202,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n                className: \"space-y-2 pt-4 border-t\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-lg font-medium\",\n                  children: \"Fotograf\\xEDa\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold\",\n                    children: \"URL\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 213,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"url\",\n                    className: \"border px-2 py-1 rounded w-full\",\n                    value: e.pictureUrl,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        pictureUrl: ev.target.value\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 214,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold\",\n                    children: \"Cita Foto\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 222,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"datetime-local\",\n                    className: \"border px-2 py-1 rounded\",\n                    value: e.photoAppointment,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        photoAppointment: ev.target.value\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 223,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 221,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => savePic(c, i),\n                  className: \"text-white px-3 py-1 rounded\",\n                  style: {\n                    backgroundColor: C.tealLight\n                  },\n                  children: \"Guardar Foto\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 230,\n                  columnNumber: 45\n                }, this), e.pictureUrl && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-1\",\n                  children: /*#__PURE__*/_jsxDEV(\"a\", {\n                    href: e.pictureUrl,\n                    target: \"_blank\",\n                    rel: \"noreferrer\",\n                    className: \"text-[#0b545b] underline\",\n                    children: \"Ver foto actual\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 237,\n                    columnNumber: 53\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n                className: \"space-y-2 pt-4 border-t\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-lg font-medium\",\n                  children: \"Comprobante de Pago\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex gap-2 items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"w-44 font-semibold\",\n                    children: \"URL\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 247,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"url\",\n                    className: \"border px-2 py-1 rounded w-full\",\n                    value: e.paymentProofUrl,\n                    onChange: ev => setEdit({\n                      ...edit,\n                      [c.idCardId]: {\n                        ...e,\n                        paymentProofUrl: ev.target.value\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 248,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => saveReq(c, i),\n                  className: \"text-white px-3 py-1 rounded\",\n                  style: {\n                    backgroundColor: C.tealDark\n                  },\n                  children: \"Guardar Comprobante\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 45\n                }, this), e.paymentProofUrl && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-1\",\n                  children: /*#__PURE__*/_jsxDEV(\"a\", {\n                    href: e.paymentProofUrl,\n                    target: \"_blank\",\n                    rel: \"noreferrer\",\n                    className: \"text-[#0b545b] underline\",\n                    children: \"Ver comprobante actual\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 53\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 37\n            }, this)]\n          }, c.idCardId, true, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 9\n  }, this);\n}\n_s(StudentIdCardPage, \"/eTBVmprjyBA04WApJLz3KywoLU=\", false, function () {\n  return [useParams];\n});\n_c = StudentIdCardPage;\nvar _c;\n$RefreshReg$(_c, \"StudentIdCardPage\");","map":{"version":3,"names":["React","useEffect","useState","useParams","Link","axios","AdminLayout","jsxDEV","_jsxDEV","API","STATUS_OPTS","C","tealLight","tealMid","tealDark","black","toISODate","d","iso","match","replace","dm","b2iso","s","slice","iso2b","StudentIdCardPage","_s","cif","cards","setCards","reqs","setReqs","stu","setStu","edit","setEdit","open","setOpen","load","cRes","rRes","sRes","Promise","all","get","c","data","filter","i","r","st","forEach","cd","req","find","q","requirementId","requirement_id","idCardId","status","notes","issueDate","deliveryAppointment","pictureId","picture_id","pictureUrl","picture_url","photoAppointment","paymentProofUrl","motive","expirationDate","selectedDegreeName","keepOpen","saveCard","idx","e","dates","Object","keys","length","patch","note","trim","alert","err","console","error","savePic","_reqRes$data$data","reqRes","reqObj","picId","put","photoUrl","saveReq","studentName","names","surnames","children","className","fileName","_jsxFileName","lineNumber","columnNumber","to","map","onClick","semester","year","value","onChange","ev","target","type","rows","style","backgroundColor","href","rel","_c","$RefreshReg$"],"sources":["/Users/karen_fonseca/Documents/UAM/Proyecto I Corte - Frontend/student-id-keeper/carnet-uam-frontend/src/pages/admin/StudentIDCard.jsx"],"sourcesContent":["// src/pages/admin/StudentIdCardPage.jsx\nimport React, { useEffect, useState } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport axios from 'axios';\nimport AdminLayout from '../../layouts/AdminLayout';\n\nconst API = 'http://localhost:8087/uam-carnet-sys';\nconst STATUS_OPTS = ['PENDING','APPROVED','REJECTED','DELIVERED','EMITTED'];\n\n/* Paleta de colores personalizada */\nconst C = {\n    tealLight: '#4da4ab',\n    tealMid: '#487e84',\n    tealDark: '#0b545b',\n    black: '#2d2e3c'\n};\n\n/* helpers fecha */\nconst toISODate = d=>{\n    if(!d) return '';\n    const iso=d.match(/^\\d{4}[-/]\\d{2}[-/]\\d{2}/);\n    if(iso) return iso[0].replace(/\\//g,'-');\n    const dm=d.match(/^(\\d{2})[-/](\\d{2})[-/](\\d{4})/);\n    return dm?`${dm[3]}-${dm[2]}-${dm[1]}`:'';\n};\nconst b2iso=s=>s?`${s.slice(6,10)}-${s.slice(3,5)}-${s.slice(0,2)}T${s.slice(11)}`:'';\nconst iso2b=s=>s?`${s.slice(8,10)}-${s.slice(5,7)}-${s.slice(0,4)} ${s.slice(11)}`:'';\n\nexport default function StudentIdCardPage(){\n    const { cif } = useParams();\n    const [cards,setCards]=useState([]); const [reqs,setReqs]=useState([]);\n    const [stu,setStu]=useState([]);    const [edit,setEdit]=useState({});\n    const [open,setOpen]=useState(null);\n\n    const load=async()=>{\n        const [cRes,rRes,sRes]=await Promise.all([\n            axios.get(`${API}/idcard`),\n            axios.get(`${API}/requirement`),\n            axios.get(`${API}/student`)\n        ]);\n        const c=cRes.data.filter(i=>i.cif===cif);\n        const r=rRes.data.filter(i=>i.cif===cif);\n        setCards(c); setReqs(r); setStu(sRes.data.filter(s=>s.cif===cif));\n\n        const st={};\n        c.forEach(cd=>{\n            const req=r.find(q=>q.requirementId===cd.requirement_id);\n            st[cd.idCardId] = {\n                status: cd.status,\n                notes: cd.notes || '',\n                issueDate: toISODate(cd.issueDate),\n                deliveryAppointment: b2iso(cd.deliveryAppointment),\n                pictureId: cd.picture_id,\n                pictureUrl: cd.picture_url || '',\n                photoAppointment: b2iso(cd.photoAppointment),\n                requirementId: req?.requirementId,\n                paymentProofUrl: req?.paymentProofUrl || '',\n                motive: req?.motive || 'No indicado',\n                expirationDate: cd.expirationDate || 'No especificada',\n                selectedDegreeName: cd.selectedDegreeName || 'No indicada',\n            };\n\n        });\n        setEdit(st);\n    };\n    useEffect(()=>{load();},[cif]);\n\n    const keepOpen=i=>setOpen(i);\n\n    const saveCard=async(cd,idx)=>{\n        const e=edit[cd.idCardId];\n        try{\n            const dates={};\n            if(e.issueDate && e.issueDate!==toISODate(cd.issueDate))\n                dates.issueDate=e.issueDate;\n            if(e.deliveryAppointment &&\n                iso2b(e.deliveryAppointment)!==cd.deliveryAppointment)\n                dates.deliveryAppointment=iso2b(e.deliveryAppointment);\n            if(Object.keys(dates).length)\n                await axios.patch(`${API}/idcard/${cd.idCardId}/dates`,dates);\n\n            if(e.status!==cd.status)\n                await axios.patch(`${API}/idcard/${cd.idCardId}/status`,{status:e.status});\n\n            const note=(e.notes||'').trim();\n            if(note && note!== (cd.notes||'').trim())\n                await axios.patch(`${API}/idcard/${cd.idCardId}/addNotes`,{notes:note});\n\n            alert('✅ Carnet actualizado');\n            await load(); keepOpen(idx);\n        }catch(err){console.error(err);alert('❌ Error al guardar carnet');}\n    };\n\n    const savePic = async (cd, idx) => {\n        const e = edit[cd.idCardId];\n        if (!e.requirementId) return alert('requirementId faltante');\n        try {\n            const reqRes = await axios.get(`${API}/requirement/${e.requirementId}`);\n            const reqObj = reqRes.data.data ?? reqRes.data;\n            const picId  = reqObj.pictureId;\n            if (!picId) return alert('pictureId no encontrado en el requirement');\n\n            await axios.put(`${API}/picture/${picId}`, {\n                ...(e.photoAppointment && { photoAppointment: iso2b(e.photoAppointment) }),\n                cif: cd.cif,\n                photoUrl: e.pictureUrl\n            });\n\n            alert('✅ Foto guardada');\n            await load(); keepOpen(idx);\n        } catch (err) {\n            console.error(err);\n            alert('❌ Error al guardar foto');\n        }\n    };\n\n    const saveReq=async(cd,idx)=>{\n        const e=edit[cd.idCardId];\n        if(!e.requirementId)return alert('requirementId faltante');\n        try{\n            await axios.put(`${API}/requirement/${e.requirementId}`,{\n                paymentProofUrl:e.paymentProofUrl\n            });\n            alert('✅ Comprobante guardado'); await load(); keepOpen(idx);\n        }catch(err){console.error(err);alert('❌ Error al guardar comprobante');}\n    };\n\n    const studentName=stu.length?`${stu[0].names} ${stu[0].surnames}`:'';\n\n    return(\n        <AdminLayout>\n            <div className=\"max-w-4xl mx-auto mt-10 p-6 bg-white rounded shadow\">\n                <h1 className=\"text-2xl font-bold mb-4\">Solicitudes de Carnet de {studentName}</h1>\n                <Link to=\"/admin/students\" className=\"text-[#0b545b] underline mb-6 block\">\n                    ← Volver a Estudiantes\n                </Link>\n\n                {!cards.length&&<p className=\"text-gray-500\">No hay solicitudes.</p>}\n\n                <div className=\"space-y-4 max-h-[70vh] overflow-y-auto pr-2\">\n                    {cards.map((c,i)=>{\n                        const e=edit[c.idCardId]||{};\n                        return(\n                            <div key={c.idCardId} className=\"border rounded-lg\">\n                                <button onClick={()=>setOpen(open===i?null:i)}\n                                        className=\"w-full p-4 bg-gray-100 flex justify-between\">\n                                    <span className=\"font-semibold\">\n                                        Semestre {c.semester} {c.year} — {c.status}\n                                    </span>\n                                    <span>{open===i?'−':'+'}</span>\n                                </button>\n\n                                {open===i&&(\n                                    <div className=\"p-4 space-y-5 bg-white rounded-b-lg\">\n                                        <section className=\"space-y-2\">\n                                            <h2 className=\"text-lg font-medium\">Detalles de la Solicitud</h2>\n                                            <p><strong>Carrera:</strong> {e.selectedDegreeName || 'No especificada'}</p>\n                                            <p><strong>Fecha de vencimiento:</strong> {e.expirationDate}</p>\n                                            <p><strong>Motivo:</strong> {e.motive}</p>\n                                        </section>\n                                        {/* carnet */}\n                                        <section className=\"space-y-2\">\n                                            <h2 className=\"text-lg font-medium\">Carnet</h2>\n                                            <div className=\"flex gap-2 items-center\">\n                                                <label className=\"w-44 font-semibold\">Estado</label>\n                                                <select value={e.status}\n                                                        onChange={ev => setEdit({\n                                                            ...edit,\n                                                            [c.idCardId]: {...e, status: ev.target.value}\n                                                        })}\n                                                        className=\"border px-2 py-1 rounded\">\n                                                    {STATUS_OPTS.map(s => <option key={s}>{s}</option>)}\n                                                </select>\n                                            </div>\n                                            <div className=\"flex gap-2 items-center\">\n                                                <label className=\"w-44 font-semibold\">Emisión</label>\n                                                <input type=\"date\" className=\"border px-2 py-1 rounded\"\n                                                       value={e.issueDate}\n                                                       onChange={ev => setEdit({\n                                                           ...edit,\n                                                           [c.idCardId]: {...e, issueDate: ev.target.value}\n                                                       })}/>\n                                            </div>\n                                            <div className=\"flex gap-2 items-center\">\n                                                <label className=\"w-44 font-semibold\">Entrega</label>\n                                                <input type=\"datetime-local\" className=\"border px-2 py-1 rounded\"\n                                                       value={e.deliveryAppointment}\n                                                       onChange={ev => setEdit({\n                                                           ...edit,\n                                                           [c.idCardId]: {...e, deliveryAppointment: ev.target.value}\n                                                       })}/>\n                                            </div>\n                                            <div className=\"flex gap-2 items-start\">\n                                                <label className=\"w-44 font-semibold mt-1\">Notas</label>\n                                                <textarea rows={3} className=\"border px-2 py-1 rounded w-full\"\n                                                          value={e.notes}\n                                                          onChange={ev => setEdit({\n                                                              ...edit,\n                                                              [c.idCardId]: {...e, notes: ev.target.value}\n                                                          })}/>\n                                            </div>\n                                            <button onClick={() => saveCard(c, i)}\n                                                    className=\"text-white px-3 py-1 rounded\"\n                                                    style={{backgroundColor: C.tealMid}}>\n                                                Guardar Carnet\n                                            </button>\n                                        </section>\n\n                                        {/* foto */}\n                                        <section className=\"space-y-2 pt-4 border-t\">\n                                            <h2 className=\"text-lg font-medium\">Fotografía</h2>\n                                            <div className=\"flex gap-2 items-center\">\n                                                <label className=\"w-44 font-semibold\">URL</label>\n                                                <input type=\"url\" className=\"border px-2 py-1 rounded w-full\"\n                                                       value={e.pictureUrl}\n                                                       onChange={ev => setEdit({\n                                                           ...edit,\n                                                           [c.idCardId]: {...e, pictureUrl: ev.target.value}\n                                                       })}/>\n                                            </div>\n                                            <div className=\"flex gap-2 items-center\">\n                                                <label className=\"w-44 font-semibold\">Cita Foto</label>\n                                                <input type=\"datetime-local\" className=\"border px-2 py-1 rounded\"\n                                                       value={e.photoAppointment}\n                                                       onChange={ev => setEdit({\n                                                           ...edit,\n                                                           [c.idCardId]: {...e, photoAppointment: ev.target.value}\n                                                       })}/>\n                                            </div>\n                                            <button onClick={() => savePic(c, i)}\n                                                    className=\"text-white px-3 py-1 rounded\"\n                                                    style={{backgroundColor: C.tealLight}}>\n                                                Guardar Foto\n                                            </button>\n                                            {e.pictureUrl && (\n                                                <p className=\"mt-1\">\n                                                    <a href={e.pictureUrl} target=\"_blank\" rel=\"noreferrer\"\n                                                       className=\"text-[#0b545b] underline\">Ver foto actual</a>\n                                                </p>\n                                            )}\n                                        </section>\n\n                                        {/* comprobante */}\n                                        <section className=\"space-y-2 pt-4 border-t\">\n                                            <h2 className=\"text-lg font-medium\">Comprobante de Pago</h2>\n                                            <div className=\"flex gap-2 items-center\">\n                                                <label className=\"w-44 font-semibold\">URL</label>\n                                                <input type=\"url\" className=\"border px-2 py-1 rounded w-full\"\n                                                       value={e.paymentProofUrl}\n                                                       onChange={ev => setEdit({\n                                                           ...edit,\n                                                           [c.idCardId]: {...e, paymentProofUrl: ev.target.value}\n                                                       })}/>\n                                            </div>\n                                            <button onClick={() => saveReq(c, i)}\n                                                    className=\"text-white px-3 py-1 rounded\"\n                                                    style={{backgroundColor: C.tealDark}}>\n                                                Guardar Comprobante\n                                            </button>\n                                            {e.paymentProofUrl && (\n                                                <p className=\"mt-1\">\n                                                    <a href={e.paymentProofUrl} target=\"_blank\" rel=\"noreferrer\"\n                                                       className=\"text-[#0b545b] underline\">Ver comprobante actual</a>\n                                                </p>\n                                            )}\n                                        </section>\n                                    </div>\n                                )}\n                            </div>\n                        );\n                    })}\n                </div>\n            </div>\n        </AdminLayout>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}